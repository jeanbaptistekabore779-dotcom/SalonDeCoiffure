{% extends "coiffure/base.html" %}
{% load static %}

{% block content %}
<div class="container py-5">

    <!-- Header -->
    <header class="mb-4 p-4 shadow rounded-4 bg-white d-flex justify-content-between align-items-center flex-wrap">
        <h1 class="fw-bold text-dark m-0">
            <i class="fas fa-list-alt me-2 text-success"></i> Historique des Paiements
        </h1>
        <a href="{% url 'ajouter_paiement' %}" class="btn btn-success btn-lg rounded-pill shadow-sm hover-scale mt-2 mt-sm-0">
            <i class="fas fa-plus me-2"></i> Ajouter un Paiement
        </a>
    </header>

    <!-- Table Card -->
    <div class="card shadow-lg border-0 rounded-4">
        <div class="card-body p-4">

            {% if paiements %}
            <div class="table-responsive">
                <table class="table table-hover table-striped align-middle text-center">
                    <thead class="table-success text-dark">
                        <tr>
                            <th>N°</th>
                            <th>Date</th>
                            <th>Client</th>
                            <th>Montant</th>
                            <th>Mode</th>
                            <th>Statut</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for paiement in paiements %}
                        <tr class="table-row-custom">
                            <td>{{ paiement.id }}</td>
                            <td>{{ paiement.date_paiement|date:"d/m/Y" }}</td>
                            <td>
                                <i class="fas fa-user me-1 text-secondary"></i>
                                {{ paiement.client.nom }} {{ paiement.client.prenom }}
                            </td>
                            <td class="fw-bold text-success">{{ paiement.montant|floatformat:2 }} FCFA</td>
                            <td>
                                <span class="badge px-3 py-2 rounded-pill
                                    {% if paiement.mode_paiement == 'espèces' %} bg-secondary
                                    {% elif paiement.mode_paiement == 'mobile' %} bg-info text-dark
                                    {% else %} bg-primary
                                    {% endif %}">
                                    {{ paiement.get_mode_paiement_display }}
                                </span>
                            </td>
                            <td>
                                {% if paiement.statut == "payé" %}
                                    <span class="badge bg-success px-3 py-2 rounded-pill">
                                        <i class="fas fa-check-circle"></i> Payé
                                    </span>
                                {% else %}
                                    <span class="badge bg-warning text-dark px-3 py-2 rounded-pill">
                                        <i class="fas fa-clock"></i> En attente
                                    </span>
                                {% endif %}
                            </td>
                            <td class="text-nowrap">
                                <a href="{% url 'detail_paiement' paiement.id %}" class="btn btn-info btn-sm rounded-pill me-1 hover-scale py-2 px-3">
                                    <i class="fas fa-eye me-1"></i> Détail
                                </a>
                                <a href="{% url 'modifier_paiement' paiement.id %}" class="btn btn-warning btn-sm text-dark rounded-pill me-1 hover-scale py-2 px-3">
                                    <i class="fas fa-edit me-1"></i> Modifier
                                </a>
                                <a href="{% url 'supprimer_paiement' paiement.id %}" class="btn btn-danger btn-sm rounded-pill me-1 hover-scale py-2 px-3" onclick="return confirm('Voulez-vous vraiment supprimer ce paiement ?');">
                                    <i class="fas fa-trash me-1"></i> Supprimer
                                </a>
                                <a href="{% url 'facture_pdf' paiement.id %}" class="btn btn-primary btn-sm rounded-pill hover-scale py-2 px-3">
                                    <i class="fas fa-print me-1"></i> Facture
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            {% else %}
            <div class="alert alert-info text-center py-5 rounded-4 shadow-sm">
                <h4 class="alert-heading mb-3">
                    <i class="fas fa-info-circle me-2"></i> Aucun Paiement Trouvé
                </h4>
                <p class="mb-4">Il n'y a pas encore d'enregistrements de transactions.</p>
                <a href="{% url 'ajouter_paiement' %}" class="btn btn-info text-white px-4 rounded-pill">
                    <i class="fas fa-plus me-2"></i> Ajouter un paiement
                </a>
            </div>
            {% endif %}

        </div>
    </div>
</div>

<style>
body {
    background: linear-gradient(to right, #e7eced, #8babca);
}

.hover-scale {
    transition: 0.2s ease-in-out;
}
.hover-scale:hover {
    transform: scale(1.05);
}

.table-row-custom:hover {
    background-color: rgba(0, 0, 0, 0.03);
}

.text-nowrap {
    white-space: nowrap;
}
</style>
{% endblock %}
